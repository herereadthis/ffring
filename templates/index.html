{% extends 'base.html' %}

{% block body %}
    {% block header %}
        <h1>{% block title %}{{ system['title'] }}!{% endblock %}</h1>
    {% endblock %}
    <ul>
        <li class="list_item"><a href="{{ system['tar1090']['url'] }}">{{ system['tar1090']['label'] }}</a></li>
        <li class="list_item"><a href="{{ system['graphs1090']['url'] }}">{{ system['graphs1090']['label'] }}</a></li>
        <li class="list_item"><a href="{{ system['piaware']['url'] }}">{{ system['piaware']['label'] }}</a></li>
        <li class="list_item"><a href="{{ system['ffring_aircraft']['url'] }}">{{ system['ffring_aircraft']['label'] }}</a></li>
    </ul>
    <h2>Closest Aircraft</h2>
    <ul>
        <li class="list_item">Flight: 
            {% if nearest_aircraft['flight'] is none %}
                unknown
            {% else %}
                <span class="code_text">{{ nearest_aircraft['flight'] }}</span>
            {% endif %}
        </li>
        <li class="list_item">Owner: {{ nearest_aircraft['owner'] }}</li>
        <li class="list_item">Aircraft: {{ nearest_aircraft['manufacturer'] }} {{ nearest_aircraft['type'] }}</li>
        <li class="list_item">ICAO: <span class="code_text">{{ nearest_aircraft['icao_24'] }}</span></li>
        <li class="list_item">Registration: <span class="code_text">{{ nearest_aircraft['registration'] }}</span></li>
        <li class="list_item">Category: {{ nearest_aircraft['category'] }}</li>
        <li class="list_item">Direction: {{ nearest_aircraft['direction'] }}</li>
        <li class="list_item">Distance: 
            <span class="code_text">
                {% if nearest_aircraft['distance'] > 5 %}
                    {{ nearest_aircraft['distance']|round(2) }} km
                {% else %}
                    {{ (nearest_aircraft['distance'] * 1000)|round|int }} m
                {% endif %}
            </span>
        </li>
        <li class="list_item">Ground Speed: <span class="code_text">{{ nearest_aircraft['gs'] }} KT</span></li>
        <li class="list_item">FlightAware:
            <a href="{{ nearest_aircraft['flightaware']['live_url']}}">Live</a> |
            <a href="{{ nearest_aircraft['flightaware']['redirect_url']}}">Redirect</a>
        </li>
    </ul>
    {% if nearest_aircraft['image'] is defined and nearest_aircraft['image']|length  %}
        <img src="{{ nearest_aircraft['image']['src'] }}"/>
    {% else %}
        <p><em>(No image found for aircraft)</em></p>
    {% endif %}
    <h2>Weather</h2>
    <ul>
        <li class="list_item">Weather: {{ weather_report['shortForecast'] }}</li>
        <li class="list_item">Temperature: 
            <span class="code_text">{{ weather_report['temperature'] }}&deg;F</span>
        </li>
        <li class="list_item">Humidity: {{ weather_report['relativeHumidity'] }}%</li>
        <li class="list_item">Precipitation: {{ weather_report['precipitation'] }}%</li>
        <li class="list_item">Wind: {{ weather_report['windDirection'] }} at {{ weather_report['windSpeed'] }}</li>
        <li class="list_item">Interval: {{ weather_report['startTime'] }} - {{ weather_report['endTime'] }}</li>
    </ul>
    <h2>Base Station</h2>
    <ul>
        <li class="list_item">Latitude: <span class="code_text">{{ receiver_options['lat'] }}</span></li>
        <li class="list_item">Longitude: <span class="code_text">{{ receiver_options['lon'] }}</span></li>
        <li class="list_item">Timezone: <span class="code_text">{{ local_timezone_name }}</span></li>
    </ul> 
    <h2>APIs</h2>
    <ul>
        <li class="list_item">Aircraft JSON:
            <a href="{{ system['urls']['aircraft'] }}">{{ system['urls']['aircraft'] }}</a>
        </li>
        <li class="list_item">Stats JSON:
            <a href="{{ system['urls']['stats'] }}">{{ system['urls']['stats'] }}</a>
        </li>
        <li class="list_item">Receiver JSON:
            <a href="{{ system['urls']['receiver'] }}">{{ system['urls']['receiver'] }}</a>
        </li>
        <li class="list_item">Weather:
            <a href="{{ weather_report['forcast_hourly_url'] }}">{{ weather_report['forcast_hourly_url'] }}</a>
        </li>
        <li class="list_item">HexDB: 
            <ul>
                <li class="list_item">Aircraft
                    <a href="{{ nearest_aircraft['hexdb']['aircraft_url'] }}">{{ nearest_aircraft['hexdb']['aircraft_url'] }}</a>
                </li>
                <li class="list_item">Conversion:
                    <a href="{{ nearest_aircraft['hexdb']['conversion_url'] }}">{{ nearest_aircraft['hexdb']['conversion_url'] }}</a>
                </li>
            </ul>
        </li>
        <li class="list_item">AdsbDB: 
            <ul>
                <li class="list_item">Aircraft
                    <a href="{{ nearest_aircraft['adsb_db']['aircraft_url'] }}">{{ nearest_aircraft['adsb_db']['aircraft_url'] }}</a>
                </li>
                <li class="list_item">Conversion:
                    <a href="{{ nearest_aircraft['adsb_db']['conversion_url'] }}">{{ nearest_aircraft['adsb_db']['conversion_url'] }}</a>
                </li>
            </ul>
        </li>
    </ul>
{% endblock %}
